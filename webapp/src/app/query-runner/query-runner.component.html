<form [formGroup]="queryBuilder" (ngSubmit)="runQuery(throwOnUndefined(buildQuery()))">
	<mat-list>
		<mat-list-item><mat-form-field>
			<mat-label>column</mat-label>
			<mat-select formControlName="column" (ngModelChange)="ngOnChanges()">
				<mat-option *ngFor="let col of columns" [value]="col">
					{{col[1]}}
				</mat-option>
			</mat-select>
		</mat-form-field></mat-list-item>

		<mat-list-item><mat-form-field>
			<mat-label>operation</mat-label>
			<mat-select formControlName="operation">
				<mat-option *ngFor="let op of operations" [value]="op">
					{{op}}
				</mat-option>
			</mat-select>
		</mat-form-field></mat-list-item>

		<mat-list-item><button mat-raised-button color="primary" type="submit" [disabled]="!queryBuilder.valid">
			launch
		</button></mat-list-item>
	</mat-list>
</form>

<mat-list>
	<mat-list-item>
		<ng-container *ngIf="state[0] === 'loading'">
			<mat-progress-bar mode="indeterminate"></mat-progress-bar>
		</ng-container>
		<ng-container *ngIf="state[0] === 'errored'">
			Error: {{state[1].message}}
		</ng-container>
		<ng-container *ngIf="state[0] === 'loaded'">
			Result:
			<ng-container *ngIf="state[1][0].kind === 'dated/years'">{{state[1][1] | date:'yyyy'}}</ng-container>
			<ng-container *ngIf="state[1][0].kind === 'dated/days'">{{state[1][1] | date}}</ng-container>
			<ng-container *ngIf="state[1][0].kind !== 'dated/years' &&
				state[1][0].kind !== 'dated/days'">{{state[1][1]}}</ng-container>
		</ng-container>
	</mat-list-item>
</mat-list>
