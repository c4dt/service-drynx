<mat-tab-group [(selectedIndex)]="tabIndex">
	<mat-tab label="query">
		<div style="height: 100px"></div>
		<form [formGroup]="queryBuilder" (ngSubmit)="runQuery(throwOnUndefined(buildQuery()))">
			<mat-list>
				<mat-list-item><mat-form-field>
					<mat-label>column</mat-label>
					<mat-select formControlName="columns" (ngModelChange)="ngOnChanges()" multiple>
						<mat-option *ngFor="let col of columns" [value]="col">
							{{col[1]}}
						</mat-option>
					</mat-select>
				</mat-form-field></mat-list-item>

				<mat-list-item><mat-form-field>
					<mat-label>operation</mat-label>
					<mat-select formControlName="operation">
						<mat-option *ngFor="let op of operations" [value]="op">
							{{op}}
						</mat-option>
					</mat-select>
				</mat-form-field></mat-list-item>

				<mat-list-item><button mat-raised-button color="primary" type="submit" [disabled]="!queryBuilder.valid">
					launch
				</button></mat-list-item>
			</mat-list>
		</form>
	</mat-tab>

	<mat-tab label="result">
		<ng-container *ngIf="state[0] === 'loading'">
			<div style="height: 100px"></div>
			<mat-progress-bar mode="indeterminate"></mat-progress-bar>
		</ng-container>
		<ng-container *ngIf="state[0] === 'errored'">
			<div style="height: 100px"></div>
			Error: {{state[1].message}}
		</ng-container>
		<ng-container *ngIf="state[0] === 'loaded'">
			<app-results-plotter [label]="state[1]" [columns]="state[2]" [results]="state[3]"
			style="height:100%;"></app-results-plotter>
		</ng-container>
	</mat-tab>
</mat-tab-group>
